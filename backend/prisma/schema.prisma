generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Restaurant {
  id     Int    @id @default(autoincrement())
  name   String
  
  menu   Item[]
  orders Order[]

  @@map("restaurants")
}

model Item {
  id           Int     @id @default(autoincrement())
  name         String
  description  String  @db.Text
  price        Float
  imageUrl     String? @map("image_url") @db.Text
  restaurantId Int     @map("restaurant_id")
  
  restaurant Restaurant @relation(fields: [restaurantId], references: [id])
  orderItems OrderItem[]

  @@map("items")
}

model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  orders Order[]

  @@map("users")
}

model Order {
  id           Int      @id @default(autoincrement())
  userId       Int      @map("user_id")
  restaurantId Int      @map("restaurant_id")
  totalPrice   Float    @map("total_price")
  createdAt    DateTime @default(now()) @map("created_at")

  user       User        @relation(fields: [userId], references: [id])
  restaurant Restaurant  @relation(fields: [restaurantId], references: [id])
  items      OrderItem[]

  @@map("orders")
}

model OrderItem {
  id       Int    @id @default(autoincrement())
  orderId  Int    @map("order_id")
  itemId   Int    @map("item_id")
  quantity Int
  size     String 
  price    Float  
  
  order Order @relation(fields: [orderId], references: [id], onDelete: Cascade)
  item  Item  @relation(fields: [itemId], references: [id])

  @@map("order_items")
}